<div class="citas-container fade-in">
  
  <div class="header-section mb-4">
    <h2 class="d-flex align-items-center">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="var(--color-primario)" class="bi bi-calendar-check-fill me-2" viewBox="0 0 16 16">
        <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4V.5zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2zm-5.146-5.146-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708z"/>
      </svg>
      Mis Citas
    </h2>
    <p class="text-muted">Gestiona y revisa el historial de tus atenciones dentales.</p>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <div *ngIf="!loading && citas.length === 0" class="text-center py-5 empty-state">
    <div class="mb-3">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="#dee2e6" class="bi bi-calendar-x" viewBox="0 0 16 16">
        <path d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708z"/>
        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
      </svg>
    </div>
    <h5 class="text-muted">No tienes citas agendadas</h5>
    <button class="btn btn-primary mt-3" routerLink="/portal/agendar-cita">
      Agendar Nueva Cita
    </button>
  </div>

  <div class="row g-4" *ngIf="!loading && citas.length > 0">
    <div class="col-md-6 col-lg-4" *ngFor="let cita of citas">
      <div class="card cita-card h-100 shadow-sm border-0">
        
        <div class="card-header bg-transparent border-0 d-flex justify-content-between align-items-center pt-3 px-3">
          <span class="badge rounded-pill" [ngClass]="getEstadoClass(cita.estado)">
            {{ cita.estado || 'PENDIENTE' }}
          </span>
          <small class="text-muted fw-bold">ID: #{{cita.id}}</small>
        </div>

        <div class="card-body px-3 pb-3">
          
          <div class="d-flex align-items-center mb-3">
            <div class="icon-box bg-light text-primary rounded-circle p-2 me-3 d-flex align-items-center justify-content-center" style="width: 48px; height: 48px;">
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-clock-fill" viewBox="0 0 16 16">
                 <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
               </svg>
            </div>
            <div>
              <h6 class="mb-0 fw-bold">{{ cita.fechaCita | date:'EEEE d MMMM, y' }}</h6>
              <small class="text-muted">{{ cita.horaCita }}</small>
            </div>
          </div>

          <hr class="my-2 opacity-25">

          <div class="mt-3">
            <div class="d-flex align-items-start mb-2">
               <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 512 512" class="me-2 mt-1 text-secondary" style="fill: currentColor;">
                <path d="M384 115.6c-22.3-15.6-46.7-25-69.5-29-10.8-1.9-20.1-13.6-18.1-24.4l3.1-17.1c2.6-14.3-8.3-27.1-22.8-27.1h-41.4c-14.5 0-25.4 12.8-22.8 27.1l3.1 17.1c2 10.8-7.3 22.5-18.1 24.4-22.8 4-47.2 13.4-69.5 29C77.4 151.7 32 245.9 32 304.5c0 74.7 47.9 133 119.8 174 19.3 11 43.1 19.8 69.8 21.5 6.6 2.2 13.3 3.6 20.4 4.1 6.3 3.9 10 4.1 14.9 3.9 4.9.2 8.6 0 14.9-3.9 7.1-.4 13.8-1.9 20.4-4.1 26.7-1.7 50.5-10.5 69.8-21.5 71.9-41 119.8-99.3 119.8-174 .1-58.6-45.3-152.8-97.8-188.9z"/>
               </svg>
               <div>
                 <small class="text-muted d-block" style="font-size: 0.8rem;">Odontólogo</small>
                 <span class="fw-medium text-dark">
                    Dr. {{ cita.odontologo?.nombre }} {{ cita.odontologo?.apellido }}
                 </span>
               </div>
            </div>

            <div class="d-flex align-items-start mt-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-card-text me-2 mt-1 text-secondary" viewBox="0 0 16 16">
                <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"/>
                <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>
              </svg>
              <div>
                <small class="text-muted d-block" style="font-size: 0.8rem;">Motivo</small>
                <span class="fw-medium text-dark">{{ cita.motivo || 'Revisión General' }}</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>